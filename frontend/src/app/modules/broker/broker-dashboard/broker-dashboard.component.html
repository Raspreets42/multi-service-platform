<div class="dashboard-container">
  <div class="dashboard-header">
    <h1>Broker Dashboard</h1>
    <p>Manage your properties and clients</p>
  </div>

  <div class="tabs">
    <button
      class="tab-btn"
      [class.active]="activeTab === 'properties'"
      (click)="setActiveTab('properties')">
      Properties ({{ properties.length }})
    </button>
    <button
      class="tab-btn"
      [class.active]="activeTab === 'clients'"
      (click)="setActiveTab('clients')">
      Clients ({{ clients.length }})
    </button>
  </div>

  <!-- Properties Tab -->
  <div class="tab-content" *ngIf="activeTab === 'properties'">
    <div class="content-header">
      <h2>Property Listings</h2>
      <button class="btn-primary" (click)="addProperty()">
        + Add Property
      </button>
    </div>

    <div class="loading" *ngIf="loading">Loading properties...</div>

    <div class="cards-grid" *ngIf="!loading && properties.length > 0">
      <div class="card" *ngFor="let property of properties; let i = index">

        <div class="card-carousel">
          <div class="carousel-container">
            <img
              [src]="getImageUrl(getCurrentImage(property, i))"
              alt="Property"
              class="carousel-image">

            <!-- Navigation Arrows -->
            <div class="carousel-controls" *ngIf="property.propertyMedia && property.propertyMedia.length > 1">
              <button class="carousel-btn prev" (click)="previousImage(property, i)">â€¹</button>
              <button class="carousel-btn next" (click)="nextImage(property, i)">â€º</button>
            </div>

            <!-- Image Indicators -->
            <div class="carousel-indicators" *ngIf="property.propertyMedia && property.propertyMedia.length > 1">
              <span
                *ngFor="let img of property.propertyMedia; let imgIndex = index"
                class="indicator"
                [class.active]="imgIndex === getCurrentImageIndex(i)"
                (click)="goToImage(property, i, imgIndex)">
              </span>
            </div>
          </div>

          <span class="badge">{{ property.propertyType }}</span>
        </div>

        <div class="card-content">
          <h3>{{ property.ownerName }}</h3>
          <p class="address">{{ property.propertyAddress }}</p>
          <p class="rent">â‚¹{{ property.propertyRent }}/month</p>
          <p class="contact">ðŸ“ž {{ property.ownerMobileNumber }}</p>
          <p class="description">{{ property.propertyDescription }}</p>
        </div>
        <div class="card-actions">
          <button class="btn-edit" (click)="editProperty(property)">Edit</button>
          <button class="btn-delete" (click)="deleteProperty(property._id!)">Delete</button>
        </div>
      </div>
    </div>

    <div class="empty-state" *ngIf="!loading && properties.length === 0">
      <p>No properties added yet. Click "Add Property" to get started.</p>
    </div>
  </div>

  <!-- Clients Tab -->
  <div class="tab-content" *ngIf="activeTab === 'clients'">
    <div class="content-header">
      <h2>Client Requests</h2>
      <button class="btn-primary" (click)="addClient()">
        + Add Client
      </button>
    </div>

    <div class="cards-grid" *ngIf="clients.length > 0">
      <div class="card" *ngFor="let client of clients">
        <div class="card-image" *ngIf="client.clientImage">
          <img [src]="getImageUrl(client.clientImage)" alt="Client">
        </div>
        <div class="card-content">
          <h3>{{ client.clientName }}</h3>
          <p class="address">{{ client.clientAddress }}</p>
          <p class="budget">Budget: â‚¹{{ client.clientBudget }}/month</p>
          <p class="contact">ðŸ“ž {{ client.clientMobileNumber }}</p>
          <p class="looking-for">Looking for: {{ client.clientLookingForPropertyType }}</p>
        </div>
        <div class="card-actions">
          <button class="btn-edit" (click)="editClient(client)">Edit</button>
          <button class="btn-delete" (click)="deleteClient(client._id!)">Delete</button>
        </div>
      </div>
    </div>

    <div class="empty-state" *ngIf="clients.length === 0">
      <p>No clients added yet. Click "Add Client" to get started.</p>
    </div>
  </div>
</div>
